{
  "extends": ["next", "next/core-web-vitals", "prettier"],
  "plugins": ["@typescript-eslint", "simple-import-sort", "tailwindcss"],
  "parser": "@typescript-eslint/parser",
  "parserOptions": {
    "project": "./tsconfig.json"
  },
  "rules": {
    "simple-import-sort/imports": "error",
    "simple-import-sort/exports": "error",
    "tailwindcss/classnames-order": "warn",
    "tailwindcss/no-custom-classname": "off",
    "tailwindcss/no-inline-styles": "off",
    "react/forbid-dom-props": "off",
    "react/forbid-component-props": "off",
    "jsx-a11y/aria-proptypes": "off",
    "no-console": ["warn", { "allow": ["warn", "error"] }],
    "@typescript-eslint/no-explicit-any": "warn",
    "@typescript-eslint/no-unsafe-assignment": "off",
    "@typescript-eslint/no-unsafe-member-access": "off",
    "no-restricted-imports": [
      "error",
      {
        "paths": [
          {
            "name": "@/src/lib/tokens",
            "message": "❌ Import from '@/src/lib/tokens/index' instead (new usage_tokens system)"
          }
        ],
        "patterns": [
          {
            "group": ["@clerk/nextjs/server"],
            "importNames": ["auth", "currentUser", "clerkClient"],
            "message": "❌ Do not import auth functions directly from @clerk/nextjs/server. Use the canonical guards from '@/lib/auth/' (requireAuth, safeOrgContext, etc.) to ensure consistent org context resolution."
          }
        ]
      }
    ],
    "no-restricted-syntax": [
      "error",
      {
        "selector": "CallExpression[callee.object.name='pool'][callee.property.name='end']",
        "message": "❌ Do not call pool.end() in API routes! Use client.release() instead. Calling pool.end() in serverless causes 'Called end on pool more than once' errors."
      },
      {
        "selector": "CallExpression[callee.object.name='pgPool'][callee.property.name='end']",
        "message": "❌ Do not call pgPool.end() in API routes! Use client.release() instead. Calling pool.end() in serverless causes 'Called end on pool more than once' errors."
      },
      {
        "selector": "NewExpression[callee.name='Pool']",
        "message": "❌ Do not create new Pool() instances! Import and use the shared pgPool from '@/lib/db' to prevent connection leaks."
      },
      {
        "selector": "NewExpression[callee.name='Stripe']",
        "message": "❌ Do not create new Stripe() instances! Import and use getStripeClient() from '@/lib/stripe' to ensure singleton pattern, consistent API version, and centralized error handling."
      },
      {
        "selector": "MemberExpression[object.object.name='process'][object.property.name='env']",
        "message": "❌ Do not access process.env directly! Import from '@/lib/config' to ensure validation and type safety. Direct env access bypasses validation and breaks at runtime with missing vars."
      }
    ]
  },
  "settings": {
    "tailwindcss": {
      "callees": ["clsx", "cn", "cva", "tv"]
    }
  }
}
